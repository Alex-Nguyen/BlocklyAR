<script>
    AFRAME.registerComponent('manager', {
        init: function(){
            $("#stage1").click(  function(){
                let audio = new Audio("assets/audio/message01.mp3");
                audio.id="playItassets/audio/message01.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>Around 8:30 am May 12, 1865 Branson led his men off to attack a Confederate camp at Palmito Ranch
                    </h4></div></div>').appendTo('body');

                let scenemodelU = document.querySelector('a-scene');

                var pos1modelU = document.querySelector('#marker1').object3D.position;

                var pos2modelU = document.querySelector('#marker2').object3D.position;

                let $objmodelU = document.querySelector('#modelU')

                let x_modelU = parseFloat("0.5 0 0".split(' ')[0]);

                let y_modelU = parseFloat("0.5 0 0".split(' ')[1]);

                let z_modelU = parseFloat("0.5 0 0".split(' ')[2]);

                $objmodelU.parentNode.removeChild($objmodelU)

                scenemodelU.appendChild($objmodelU.cloneNode());

                $($objmodelU).attr("position",[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "))

                let curvemodelU = document.createElement('a-curve');

                $("#marker1marker2").remove();

                curvemodelU.setAttribute('id', 'marker1marker2');

                let curvePoint1modelU = document.createElement('a-curve-point');

                let curvePoint2modelU = document.createElement('a-curve-point');

                curvePoint1modelU.setAttribute('position',[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "));

                curvePoint2modelU.setAttribute('position', [pos2modelU.x + x_modelU, pos2modelU.y+y_modelU, pos2modelU.z+z_modelU].join(" "));

                curvemodelU.appendChild(curvePoint1modelU);

                curvemodelU.appendChild(curvePoint2modelU);

                scenemodelU.appendChild(curvemodelU);

                $("#modelU").attr("alongpath","curve: #marker1marker2; dur: 3000; rotate: true; delay: 2000")

                $("#modelU").attr("animation-mixer",'clip: Walking');
                $("#modelU").off("movingended","**")
                $("#modelU").on('movingended', function(){
                    $("#modelU").attr("animation-mixer",'clip: Attack');

                    $("#modelC").attr("animation-mixer",'clip: Attack');

                    let audio = new Audio("assets/audio/Sword.mp3");
                    audio.id="playItassets/audio/Sword.mp3";

                    document.body.appendChild(audio);

                    audio.play();
                    setTimeout(function(){
                        $("audio").trigger("pause")
                        $("#stage2").trigger('click');
                    },6000)
                })});
            $("#stage2").click(  function(){
                let audio = new Audio("assets/audio/message02.mp3");
                audio.id="playItassets/audio/message02.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>After much skirmishing along the way, the Federals attacked the camp and scattered the Confederates
                    </h4></div></div>').appendTo('body');

                let scenemodelC = document.querySelector('a-scene');

                var pos1modelC = document.querySelector('#marker2').object3D.position;

                var pos2modelC = document.querySelector('#marker4').object3D.position;

                let $objmodelC = document.querySelector('#modelC')

                let x_modelC = parseFloat("0 0 0".split(' ')[0]);

                let y_modelC = parseFloat("0 0 0".split(' ')[1]);

                let z_modelC = parseFloat("0 0 0".split(' ')[2]);

                $objmodelC.parentNode.removeChild($objmodelC)

                scenemodelC.appendChild($objmodelC.cloneNode());

                $($objmodelC).attr("position",[pos1modelC.x, pos1modelC.y, pos1modelC.z].join(" "))

                let curvemodelC = document.createElement('a-curve');

                $("#marker2marker4").remove();

                curvemodelC.setAttribute('id', 'marker2marker4');

                let curvePoint1modelC = document.createElement('a-curve-point');

                let curvePoint2modelC = document.createElement('a-curve-point');

                curvePoint1modelC.setAttribute('position',[pos1modelC.x, pos1modelC.y, pos1modelC.z].join(" "));

                curvePoint2modelC.setAttribute('position', [pos2modelC.x + x_modelC, pos2modelC.y+y_modelC, pos2modelC.z+z_modelC].join(" "));

                curvemodelC.appendChild(curvePoint1modelC);

                curvemodelC.appendChild(curvePoint2modelC);

                scenemodelC.appendChild(curvemodelC);

                $("#modelC").attr("alongpath","curve: #marker2marker4; dur: 3000; rotate: true; delay: 2000")

                $("#modelC").attr("animation-mixer",'clip: Running');

                $("#modelU").attr("animation-mixer",'clip: Idle');
                $("#modelC").off("movingended","**")
                $("#modelC").on('movingended', function(){
                    $("#modelC").attr("animation-mixer",'clip: Idle');

                    setTimeout(function(){
                        $("#stage3").trigger('click');
                    },4000)
                })});
            $("#stage3").click(  function(){
                let audio = new Audio("assets/audio/message03.mp3");
                audio.id="playItassets/audio/message03.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>The Union took Palmito Ranch, burning any supplies that they found abandoned at the camp, and capturing three prisoners. Branson and his men remained at the site to feed themselves and their horses
                    </h4></div></div>').appendTo('body');

                let scenemodelU = document.querySelector('a-scene');

                var pos1modelU = document.querySelector('#marker2').object3D.position;

                var pos2modelU = document.querySelector('#marker3').object3D.position;

                let $objmodelU = document.querySelector('#modelU')

                let x_modelU = parseFloat("0 0 0".split(' ')[0]);

                let y_modelU = parseFloat("0 0 0".split(' ')[1]);

                let z_modelU = parseFloat("0 0 0".split(' ')[2]);

                $objmodelU.parentNode.removeChild($objmodelU)

                scenemodelU.appendChild($objmodelU.cloneNode());

                $($objmodelU).attr("position",[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "))

                let curvemodelU = document.createElement('a-curve');

                $("#marker2marker3").remove();

                curvemodelU.setAttribute('id', 'marker2marker3');

                let curvePoint1modelU = document.createElement('a-curve-point');

                let curvePoint2modelU = document.createElement('a-curve-point');

                curvePoint1modelU.setAttribute('position',[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "));

                curvePoint2modelU.setAttribute('position', [pos2modelU.x + x_modelU, pos2modelU.y+y_modelU, pos2modelU.z+z_modelU].join(" "));

                curvemodelU.appendChild(curvePoint1modelU);

                curvemodelU.appendChild(curvePoint2modelU);

                scenemodelU.appendChild(curvemodelU);

                $("#modelU").attr("alongpath","curve: #marker2marker3; dur: 3000; rotate: true; delay: 2000")

                $("#modelU").attr("animation-mixer",'clip: Walking');
                $("#modelU").off("movingended","**")
                $("#modelU").on('movingended', function(){
                    $("#modelU").attr("animation-mixer",'clip: Resting');

                    setTimeout(function(){
                        $("#stage4").trigger('click');
                    },6000)
                })});
            $("#stage4").click(  function(){
                let audio = new Audio("assets/audio/message04.mp3");
                audio.id="playItassets/audio/message04.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>At 3:00 pm, a sizable Confederate force appeared, influencing the Federals to retire to Whites Ranch</h4></div></div>').appendTo('body');

                let scenemodelC = document.querySelector('a-scene');

                var pos1modelC = document.querySelector('#marker4').object3D.position;

                var pos2modelC = document.querySelector('#marker2').object3D.position;

                let $objmodelC = document.querySelector('#modelC')

                let x_modelC = parseFloat("-0.5 0 0".split(' ')[0]);

                let y_modelC = parseFloat("-0.5 0 0".split(' ')[1]);

                let z_modelC = parseFloat("-0.5 0 0".split(' ')[2]);

                $objmodelC.parentNode.removeChild($objmodelC)

                scenemodelC.appendChild($objmodelC.cloneNode());

                $($objmodelC).attr("position",[pos1modelC.x, pos1modelC.y, pos1modelC.z].join(" "))

                let curvemodelC = document.createElement('a-curve');

                $("#marker4marker2").remove();

                curvemodelC.setAttribute('id', 'marker4marker2');

                let curvePoint1modelC = document.createElement('a-curve-point');

                let curvePoint2modelC = document.createElement('a-curve-point');

                curvePoint1modelC.setAttribute('position',[pos1modelC.x, pos1modelC.y, pos1modelC.z].join(" "));

                curvePoint2modelC.setAttribute('position', [pos2modelC.x + x_modelC, pos2modelC.y+y_modelC, pos2modelC.z+z_modelC].join(" "));

                curvemodelC.appendChild(curvePoint1modelC);

                curvemodelC.appendChild(curvePoint2modelC);

                scenemodelC.appendChild(curvemodelC);

                $("#modelC").attr("alongpath","curve: #marker4marker2; dur: 3000; rotate: true; delay: 2000")

                $("#modelC").attr("animation-mixer",'clip: Walking');

                let scenemodelU = document.querySelector('a-scene');

                var pos1modelU = document.querySelector('#marker3').object3D.position;

                var pos2modelU = document.querySelector('#marker2').object3D.position;

                let $objmodelU = document.querySelector('#modelU')

                let x_modelU = parseFloat("0.5 0 0".split(' ')[0]);

                let y_modelU = parseFloat("0.5 0 0".split(' ')[1]);

                let z_modelU = parseFloat("0.5 0 0".split(' ')[2]);

                $objmodelU.parentNode.removeChild($objmodelU)

                scenemodelU.appendChild($objmodelU.cloneNode());

                $($objmodelU).attr("position",[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "))

                let curvemodelU = document.createElement('a-curve');

                $("#marker3marker2").remove();

                curvemodelU.setAttribute('id', 'marker3marker2');

                let curvePoint1modelU = document.createElement('a-curve-point');

                let curvePoint2modelU = document.createElement('a-curve-point');

                curvePoint1modelU.setAttribute('position',[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "));

                curvePoint2modelU.setAttribute('position', [pos2modelU.x + x_modelU, pos2modelU.y+y_modelU, pos2modelU.z+z_modelU].join(" "));

                curvemodelU.appendChild(curvePoint1modelU);

                curvemodelU.appendChild(curvePoint2modelU);

                scenemodelU.appendChild(curvemodelU);

                $("#modelU").attr("alongpath","curve: #marker3marker2; dur: 3000; rotate: true; delay: 2000")

                $("#modelU").attr("animation-mixer",'clip: Walking');
                $("#modelC").off("movingended","**")
                $("#modelC").on('movingended', function(){
                    $("#modelC").attr("animation-mixer",'clip: Attack');

                    $("#modelU").attr("animation-mixer",'clip: Attack');

                    setTimeout(function(){
                        $("#modelC").attr("animation-mixer",'clip: Idle');

                        let scenemodelU = document.querySelector('a-scene');

                        var pos1modelU = document.querySelector('#marker2').object3D.position;

                        var pos2modelU = document.querySelector('#marker1').object3D.position;

                        let $objmodelU = document.querySelector('#modelU')

                        let x_modelU = parseFloat("0 0 0".split(' ')[0]);

                        let y_modelU = parseFloat("0 0 0".split(' ')[1]);

                        let z_modelU = parseFloat("0 0 0".split(' ')[2]);

                        $objmodelU.parentNode.removeChild($objmodelU)

                        scenemodelU.appendChild($objmodelU.cloneNode());

                        $($objmodelU).attr("position",[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "))

                        let curvemodelU = document.createElement('a-curve');

                        $("#marker2marker1").remove();

                        curvemodelU.setAttribute('id', 'marker2marker1');

                        let curvePoint1modelU = document.createElement('a-curve-point');

                        let curvePoint2modelU = document.createElement('a-curve-point');

                        curvePoint1modelU.setAttribute('position',[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "));

                        curvePoint2modelU.setAttribute('position', [pos2modelU.x + x_modelU, pos2modelU.y+y_modelU, pos2modelU.z+z_modelU].join(" "));

                        curvemodelU.appendChild(curvePoint1modelU);

                        curvemodelU.appendChild(curvePoint2modelU);

                        scenemodelU.appendChild(curvemodelU);

                        $("#modelU").attr("alongpath","curve: #marker2marker1; dur: 3000; rotate: true; delay: 2000")

                        $("#modelU").attr("animation-mixer",'clip: Running');
                        $("#modelU").off("movingended","**")
                        $("#modelU").on('movingended', function(){
                            $("#modelU").attr("animation-mixer",'clip: Idle');

                            setTimeout(function(){
                                $("#stage5").trigger('click');
                            },3000)
                        })},5000)
                })});
            $("#stage5").click(  function(){
                let audio = new Audio("assets/audio/message05.mp3");
                audio.id="playItassets/audio/message05.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>On the 13th, with 200 augmented men, the Union started out towards Palmito Ranch, skirmishing most of the way. They destroyed the rest of the supplies not torched the day before and continued on
                    </h4></div></div>').appendTo('body');
            });
            $("#stage6").click(  function(){
                let audio = new Audio("assets/audio/message06.mp3");
                audio.id="playItassets/audio/message06.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>After the fighting stopped, Barrett led his force back to a bluff at Tulosa on the river where the men could prepare dinner and camp for the night</h4></div></div>').appendTo('body');
            });
            $("#stage7").click(  function(){
                let audio = new Audio("assets/audio/message07.mp3");
                audio.id="playItassets/audio/message07.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>At 4:00 pm, a large Confederate cavalry force, commanded by Col. John S. Ford, approached. The Rebels hammered the Union line with artillery</h4></div></div>').appendTo('body');
            });
            $("#stage8").click(  function(){
                let audio = new Audio("assets/audio/message08.mp3");
                audio.id="playItassets/audio/message08.mp3";

                document.body.appendChild(audio);

                audio.play();
                $("div#message").remove();

                $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>To preclude an enemy flanking movement, Barrett ordered a retreat. This was the last battle in the Civil War</h4></div></div>').appendTo('body');

                let scenemodelU = document.querySelector('a-scene');

                var pos1modelU = document.querySelector('#marker2').object3D.position;

                var pos2modelU = document.querySelector('#marker1').object3D.position;

                let $objmodelU = document.querySelector('#modelU')

                let x_modelU = parseFloat("0 0 0".split(' ')[0]);

                let y_modelU = parseFloat("0 0 0".split(' ')[1]);

                let z_modelU = parseFloat("0 0 0".split(' ')[2]);

                $objmodelU.parentNode.removeChild($objmodelU)

                scenemodelU.appendChild($objmodelU.cloneNode());

                $($objmodelU).attr("position",[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "))

                let curvemodelU = document.createElement('a-curve');

                $("#marker2marker1").remove();

                curvemodelU.setAttribute('id', 'marker2marker1');

                let curvePoint1modelU = document.createElement('a-curve-point');

                let curvePoint2modelU = document.createElement('a-curve-point');

                curvePoint1modelU.setAttribute('position',[pos1modelU.x, pos1modelU.y, pos1modelU.z].join(" "));

                curvePoint2modelU.setAttribute('position', [pos2modelU.x + x_modelU, pos2modelU.y+y_modelU, pos2modelU.z+z_modelU].join(" "));

                curvemodelU.appendChild(curvePoint1modelU);

                curvemodelU.appendChild(curvePoint2modelU);

                scenemodelU.appendChild(curvemodelU);

                $("#modelU").attr("alongpath","curve: #marker2marker1; dur: 3000; rotate: true; delay: 2000")

                $("#modelC").attr("animation-mixer",'clip: Idle');

                $("#modelU").attr("animation-mixer",'clip: Running');
                $("#modelU").off("movingended","**")
                $("#modelU").on('movingended', function(){
                    $("#modelU").attr("animation-mixer",'clip: Idle');

                    $("div#message").remove();

                    $('<div id="message" class="fixed-bottom mb-4"><div class="text-center pl-5 pr-5 bg-info message"><h4>The end</h4></div></div>').appendTo('body');

                })});

        }

    });
</script>
<div class="fixed-top mt-4">
    <ul class="nav nav-pills nav-justified">
        <li class="nav-item"><button type="button" id='stage1' class="btn btn-dark stage">S1</button></li>

        <li class="nav-item"><button type="button" id='stage2' class="btn btn-dark stage">S2</button></li>

        <li class="nav-item"><button type="button" id='stage3' class="btn btn-dark stage">S3</button></li>

        <li class="nav-item"><button type="button" id='stage4' class="btn btn-dark stage">S4</button></li>

        <li class="nav-item"><button type="button" id='stage5' class="btn btn-dark stage">S5</button></li>

        <li class="nav-item"><button type="button" id='stage6' class="btn btn-dark stage">S6</button></li>

        <li class="nav-item"><button type="button" id='stage7' class="btn btn-dark stage">S7</button></li>

        <li class="nav-item"><button type="button" id='stage8' class="btn btn-dark stage">S8</button></li>

    </ul>
</div>
<a-scene manager arjs>
    <a-marker project='visAR' id='marker1' type='pattern' url='assets/patterns/letterA.patt'>
        <a-gltf-model look-at="[camera]" id="modelU" project='visAR'  src = 'assets/models/FinalUnion.glb'></a-gltf-model>
    </a-marker>
    <a-marker project='visAR' id='marker2' type='pattern' url='assets/patterns/letterB.patt'>
        <a-gltf-model look-at="[camera]" id="modelC" project='visAR'  src = 'assets/models/confTroop.glb'></a-gltf-model>
    </a-marker>
    <a-marker project='visAR' id='marker3' type='pattern' url='assets/patterns/letterC.patt'>

    </a-marker>
    <a-marker project='visAR' id='marker4' type='pattern' url='assets/patterns/letterD.patt'>

    </a-marker>

    <a-entity camera></a-entity>
</a-scene>